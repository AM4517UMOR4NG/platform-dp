<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Storybook</title>
    <style>
        /* CSS remains unchanged as per your request */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #81CFFE 0%, #8BC34A 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px;
        }

        /* Landing Page */
        .splash-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            animation: fadeIn 1.5s ease-in;
        }

        .logo {
            font-size: 48px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        .character {
            width: 200px;
            height: 200px;
            background: #FFD54F;
            border-radius: 50%;
            margin: 20px 0;
            position: relative;
            animation: float 3s ease-in-out infinite;
        }

        .character::before {
            content: "üëß";
            font-size: 100px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .btn {
            background: #FFD54F;
            color: #333;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            margin: 8px;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        /* Home Page */
        .home-page {
            display: none;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .avatar {
            width: 60px;
            height: 60px;
            background: #F8BBD0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }

        .level-info {
            color: #333;
        }

        .progress-bar {
            width: 200px;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: #8BC34A;
            width: 65%;
            transition: width 0.5s ease;
        }

        .carousel {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .carousel-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 16px;
        }

        .story-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }

        .story-card {
            background: linear-gradient(135deg, #CE93D8, #F8BBD0);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .story-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .category-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .category-card:hover {
            transform: scale(1.05);
        }

        .category-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        /* Story Library */
        .library-page {
            display: none;
        }

        .filters {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .filter-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .filter-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 16px;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 16px;
        }

        /* Story Reader */
        .reader-page {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .reader-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid #eee;
        }

        .reader-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            min-height: 400px;
        }

        .text-panel {
            display: flex;
            flex-direction: column;
        }

        .story-text {
            font-size: 20px;
            line-height: 1.6;
            color: #333;
            margin-bottom: 20px;
        }

        .highlighted {
            background: #FFD54F;
            padding: 2px 4px;
            border-radius: 4px;
            animation: pulse 1s;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 16px;
            background: #f5f5f5;
            padding: 16px;
            border-radius: 12px;
        }

        .play-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #8BC34A;
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            transform: scale(1.1);
        }

        .audio-progress {
            flex: 1;
            height: 8px;
            background: #eee;
            border-radius: 4px;
            overflow: hidden;
        }

        .audio-progress-fill {
            height: 100%;
            background: #8BC34A;
            width: 0%;
            transition: width 0.3s ease;
        }

        .illustration-panel {
            background: linear-gradient(135deg, #81CFFE, #8BC34A);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .illustration {
            font-size: 120px;
            animation: float 3s ease-in-out infinite;
        }

        .hotspot {
            position: absolute;
            width: 30px;
            height: 30px;
            background: #FFD54F;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: bounce 2s infinite;
        }

        /* Activity Pages */
        .activity-page {
            display: none;
        }

        .game-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }

        .game-title {
            font-size: 28px;
            color: #333;
            margin-bottom: 20px;
        }

        .drag-drop-area {
            background: #f9f9f9;
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            min-height: 100px;
            position: relative;
        }

        .word-pieces {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .word-piece {
            background: #FFD54F;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: grab;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .word-piece:hover {
            transform: scale(1.05);
        }

        .word-piece.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .game-progress {
            width: 100%;
            height: 20px;
            background: #eee;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .game-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8BC34A, #FFD54F);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Dashboard */
        .dashboard-page {
            display: none;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #8BC34A;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #666;
            font-size: 16px;
        }

        .badge-collection {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .badges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .badge {
            background: linear-gradient(135deg, #CE93D8, #F8BBD0);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            color: white;
            font-size: 12px;
        }

        .badge-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        /* Recording Mode */
        .record-mode {
            display: none;
            text-align: center;
        }

        .mic-container {
            margin: 30px 0;
        }

        .mic-btn {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: #FF5722;
            color: white;
            border: none;
            font-size: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .mic-btn.recording {
            animation: pulse 1s infinite;
            background: #F44336;
        }

        .recording-wave {
            width: 100%;
            height: 60px;
            background: #f5f5f5;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .wave-bar {
            width: 4px;
            background: #8BC34A;
            margin: 0 2px;
            border-radius: 2px;
            animation: wave 1s ease-in-out infinite;
        }

        .score-display {
            font-size: 48px;
            color: #FFD54F;
            margin: 20px 0;
        }

        /* Navigation */
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 16px;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
        }

        .nav-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-btn.active {
            color: #8BC34A;
            background: rgba(139, 195, 74, 0.1);
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .tooltip.show {
            opacity: 1;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #FFD54F;
            animation: confetti-fall 3s linear infinite;
            z-index: 1000;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes wave {
            0%, 100% { height: 20px; }
            50% { height: 40px; }
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .reader-content {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 12px;
            }
            
            .logo {
                font-size: 36px;
            }
            
            .nav-bar {
                padding-bottom: calc(16px + env(safe-area-inset-bottom));
            }
        }

        /* Hide scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #999;
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="splashScreen" class="splash-screen">
        <div class="logo">üìö Interactive Storybook</div>
        <div class="character"></div>
        <p style="color: white; font-size: 18px; margin-bottom: 30px;">
            Belajar kosakata sambil bercerita!
        </p>
        <button class="btn" onclick="showHome()">Mulai Petualangan</button>
        <button class="btn" onclick="showProfiles()">Pilih Profil</button>
    </div>

    <!-- Home Page -->
    <div id="homePage" class="home-page">
        <div class="container">
            <div class="header">
                <div class="profile">
                    <div class="avatar">üëß</div>
                    <div>
                        <div class="level-info">
                            <strong>Sari</strong> - Penjelajah Level 2
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="showDashboard()">Dashboard</button>
            </div>

            <div class="carousel">
                <h2 class="carousel-title">üåü Cerita Terbaru</h2>
                <div class="story-cards">
                    <div class="story-card" onclick="showStoryDetail('petualangan-hutan')">
                        <div style="font-size: 48px; margin-bottom: 12px;">üå≥</div>
                        <h3>Petualangan di Hutan</h3>
                        <p>Ikuti Kiki menemukan hewan-hewan lucu!</p>
                        <div style="margin-top: 12px;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="story-card" onclick="showStoryDetail('rumah-kecil')">
                        <div style="font-size: 48px; margin-bottom: 12px;">üè†</div>
                        <h3>Rumah Kecil</h3>
                        <p>Cerita tentang keluarga yang bahagia</p>
                        <div style="margin-top: 12px;">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="story-card" onclick="showStoryDetail('laut-biru')">
                        <div style="font-size: 48px; margin-bottom: 12px;">üåä</div>
                        <h3>Laut Biru</h3>
                        <p>Menyelami keindahan dunia bawah laut</p>
                        <div style="margin-top: 12px;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                </div>
            </div>

            <div class="categories">
                <div class="category-card" onclick="showLibrary('hewan')">
                    <div class="category-icon">üêæ</div>
                    <h3>Hewan</h3>
                    <p>12 cerita</p>
                </div>
                <div class="category-card" onclick="showLibrary('petualangan')">
                    <div class="category-icon">‚õ∞Ô∏è</div>
                    <h3>Petualangan</h3>
                    <p>8 cerita</p>
                </div>
                <div class="category-card" onclick="showLibrary('persahabatan')">
                    <div class="category-icon">ü§ù</div>
                    <h3>Persahabatan</h3>
                    <p>15 cerita</p>
                </div>
                <div class="category-card" onclick="showLibrary('eksplorasi')">
                    <div class="category-icon">üîç</div>
                    <h3>Eksplorasi</h3>
                    <p>10 cerita</p>
                </div>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button class="btn" onclick="continueReading()">üìñ Lanjutkan Cerita</button>
                <button class="btn" onclick="showLibrary()">üìö Perpustakaan</button>
            </div>
        </div>
    </div>

    <!-- Story Library -->
    <div id="libraryPage" class="library-page">
        <div class="container">
            <div class="filters">
                <h2>üìö Perpustakaan Cerita</h2>
                <div class="filter-row">
                    <div class="filter-group">
                        <label class="filter-label">Rentang Usia</label>
                        <select class="filter-select">
                            <option>Semua Usia</option>
                            <option>4-5 tahun</option>
                            <option>5-6 tahun</option>
                            <option>6-7 tahun</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Tema</label>
                        <select class="filter-select">
                            <option>Semua Tema</option>
                            <option>Hewan</option>
                            <option>Petualangan</option>
                            <option>Persahabatan</option>
                            <option>Eksplorasi</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Level Kosakata</label>
                        <select class="filter-select">
                            <option>Semua Level</option>
                            <option>Pemula</option>
                            <option>Menengah</option>
                            <option>Lanjutan</option>
                        </select>
                    </div>
                </div>
                <input type="text" class="search-box" placeholder="Cari cerita...">
            </div>

            <div class="story-cards" id="storyGrid">
                <!-- Stories will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Story Reader -->
    <div id="readerPage" class="reader-page">
        <div class="container">
            <div class="reader-header">
                <button class="btn" onclick="goBack()">‚Üê Kembali</button>
                <h2 id="storyTitle">Petualangan di Hutan</h2>
                <div>
                    <button class="btn" onclick="toggleRecordMode()">üé§ Mode Rekam</button>
                    <button class="btn" onclick="showActivities()">üéÆ Aktivitas</button>
                </div>
            </div>

            <div class="reader-content">
                <div class="text-panel">
                    <div class="story-text" id="storyText">
                        Pada suatu hari yang <span class="word-highlight" onclick="showDefinition('cerah')">cerah</span>, 
                        Kiki berjalan ke <span class="word-highlight" onclick="showDefinition('hutan')">hutan</span>. 
                        Dia melihat <span class="word-highlight" onclick="showDefinition('kupu-kupu')">kupu-kupu</span> 
                        yang cantik terbang di antara <span class="word-highlight" onclick="showDefinition('bunga')">bunga</span>-bunga.
                    </div>
                    
                    <div class="audio-controls">
                        <button class="play-btn" id="playBtn" onclick="toggleAudio()">‚ñ∂Ô∏è</button>
                        <div class="audio-progress">
                            <div class="audio-progress-fill" id="audioProgress"></div>
                        </div>
                        <span id="audioTime">0:00 / 2:30</span>
                    </div>
                </div>

                <div class="illustration-panel">
                    <div class="illustration" id="mainIllustration">üå≥</div>
                    <div class="hotspot" style="top: 30%; left: 20%;" onclick="showHotspot('kupu-kupu')">ü¶ã</div>
                    <div class="hotspot" style="top: 60%; left: 70%;" onclick="showHotspot('bunga')">üå∏</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity Page -->
    <div id="activityPage" class="activity-page">
        <div class="container">
            <div class="game-container">
                <h2 class="game-title" id="gameTitle">üéØ Susun Kalimat</h2>
                <p id="gameInstruction">Seret kata-kata ke tempat yang tepat!</p>
                
                <div class="game-progress">
                    <div class="game-progress-fill" id="gameProgress"></div>
                </div>

                <div class="drag-drop-area" id="dropZone">
                    <p style="color: #999;">Seret kata-kata ke sini</p>
                </div>

                <div class="word-pieces" id="wordPieces">
                    <div class="word-piece" draggable="true">Kiki</div>
                    <div class="word-piece" draggable="true">berjalan</div>
                    <div class="word-piece" draggable="true">ke</div>
                    <div class="word-piece" draggable="true">hutan</div>
                </div>

                <button class="btn" onclick="checkAnswer()" style="margin-top: 20px;">Periksa Jawaban</button>
                <button class="btn" onclick="nextGame()">Permainan Berikutnya</button>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardPage" class="dashboard-page">
        <div class="container">
            <h2 style="color: white; text-align: center; margin-bottom: 30px;">üìä Dashboard Progres</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">156</div>
                    <div class="stat-label">Kata Dikuasai</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">23</div>
                    <div class="stat-label">Cerita Selesai</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">45</div>
                    <div class="stat-label">Menit Hari Ini</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">Level 2</div>
                    <div class="stat-label">Penjelajah</div>
                </div>
            </div>

            <div class="badge-collection">
                <h3>üèÜ Koleksi Lencana</h3>
                <div class="badges-grid">
                    <div class="badge">
                        <div class="badge-icon">üêæ</div>
                        <div>Animal Expert</div>
                    </div>
                    <div class="badge">
                        <div class="badge-icon">üìö</div>
                        <div>Story Master</div>
                    </div>
                    <div class="badge">
                        <div class="badge-icon">üéØ</div>
                        <div>Perfect Score</div>
                    </div>
                    <div class="badge">
                        <div class="badge-icon">‚≠ê</div>
                        <div>First Story</div>
                    </div>
                    <div class="badge">
                        <div class="badge-icon">üèÉ</div>
                        <div>Speed Reader</div>
                    </div>
                    <div class="badge">
                        <div class="badge-icon">üé§</div>
                        <div>Voice Champion</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recording Mode -->
    <div id="recordMode" class="record-mode">
        <div class="container">
            <div class="game-container">
                <h2 class="game-title">üé§ Mode Rekam & Ulangi</h2>
                <p>Bacakan kalimat berikut dengan jelas:</p>
                
                <div style="background: #f9f9f9; padding: 20px; border-radius: 12px; margin: 20px 0;">
                    <p style="font-size: 24px; color: #333; text-align: center;">
                        "Kiki berjalan ke hutan yang hijau"
                    </p>
                </div>

                <div class="mic-container">
                    <button class="mic-btn" id="micBtn" onclick="toggleRecording()">üé§</button>
                    <p id="recordStatus">Tekan untuk mulai merekam</p>
                </div>

                <div class="recording-wave" id="recordingWave" style="display: none;">
                    <div class="wave-bar" style="animation-delay: 0s; height: 20px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.1s; height: 30px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.2s; height: 25px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.3s; height: 35px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.4s; height: 20px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.5s; height: 40px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.6s; height: 30px;"></div>
                    <div class="wave-bar" style="animation-delay: 0.7s; height: 25px;"></div>
                </div>

                <div class="score-display" id="scoreDisplay" style="display: none;">
                    ‚≠ê‚≠ê‚≠ê
                </div>

                <div style="margin-top: 20px;">
                    <button class="btn" onclick="playRecording()" style="display: none;" id="playbackBtn">‚ñ∂Ô∏è Putar Rekaman</button>
                    <button class="btn" onclick="compareWithNarrator()">üîÑ Bandingkan dengan Narator</button>
                    <button class="btn" onclick="nextSentence()">‚û°Ô∏è Kalimat Berikutnya</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <div class="nav-bar">
        <button class="nav-btn active" onclick="showHome()">
            <div class="nav-icon">üè†</div>
            <div>Beranda</div>
        </button>
        <button class="nav-btn" onclick="showLibrary()">
            <div class="nav-icon">üìö</div>
            <div>Perpustakaan</div>
        </button>
        <button class="nav-btn" onclick="continueReading()">
            <div class="nav-icon">üìñ</div>
            <div>Baca</div>
        </button>
        <button class="nav-btn" onclick="showActivities()">
            <div class="nav-icon">üéÆ</div>
            <div>Aktivitas</div>
        </button>
        <button class="nav-btn" onclick="showDashboard()">
            <div class="nav-icon">üìä</div>
            <div>Progres</div>
        </button>
    </div>

    <!-- Modal for definitions -->
    <div class="modal" id="definitionModal">
        <div class="modal-content">
            <h3 id="wordTitle">Kata</h3>
            <div id="wordDefinition">Definisi kata</div>
            <div style="margin: 20px 0;">
                <button class="btn" onclick="playWordAudio()">üîä Dengar</button>
            </div>
            <button class="btn" onclick="closeModal()">Tutup</button>
        </div>
    </div>

    <!-- Modal for game feedback -->
    <div class="modal" id="gameFeedbackModal">
        <div class="modal-content">
            <h3 id="feedbackTitle">Hasil</h3>
            <div id="feedbackMessage"></div>
            <button class="btn" onclick="closeFeedbackModal()">Tutup</button>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // Global state
        let currentPage = 'splash';
        let isPlaying = false;
        let isRecording = false;
        let audioProgress = 0;
        let gameProgress = 0;
        let currentStory = null;
        let currentGameType = 'sentence'; // Track current game type: 'sentence' or 'matching'
        let userProfile = {
            name: 'Sari',
            level: 2,
            wordsLearned: 156,
            storiesCompleted: 23,
            badges: ['Animal Expert', 'Story Master', 'Perfect Score', 'First Story', 'Speed Reader', 'Voice Champion']
        };

        // Story data
        const stories = {
            'petualangan-hutan': {
                title: 'Petualangan di Hutan',
                content: 'Pada suatu hari yang cerah, Kiki berjalan ke hutan. Dia melihat kupu-kupu yang cantik terbang di antara bunga-bunga.',
                illustration: 'üå≥',
                words: ['cerah', 'hutan', 'kupu-kupu', 'bunga'],
                hotspots: [
                    { emoji: 'ü¶ã', word: 'kupu-kupu', position: { top: '30%', left: '20%' } },
                    { emoji: 'üå∏', word: 'bunga', position: { top: '60%', left: '70%' } }
                ]
            },
            'rumah-kecil': {
                title: 'Rumah Kecil',
                content: 'Di sebuah desa yang tenang, terdapat rumah kecil berwarna kuning. Keluarga bahagia tinggal di sana.',
                illustration: 'üè†',
                words: ['desa', 'rumah', 'kuning', 'keluarga'],
                hotspots: []
            },
            'laut-biru': {
                title: 'Laut Biru',
                content: 'Ikan-ikan berenang di laut biru. Ada ikan badut, ikan pari, dan bintang laut yang indah.',
                illustration: 'üåä',
                words: ['laut', 'berenang', 'badut', 'bintang'],
                hotspots: []
            }
        };

        // Word definitions
        const definitions = {
            'cerah': {
                definition: 'Terang dan tidak mendung, seperti hari yang penuh sinar matahari',
                example: 'Hari ini cuaca sangat cerah'
            },
            'hutan': {
                definition: 'Tempat yang dipenuhi dengan banyak pohon dan tanaman',
                example: 'Banyak binatang hidup di hutan'
            },
            'kupu-kupu': {
                definition: 'Serangga cantik yang memiliki sayap berwarna-warni',
                example: 'Kupu-kupu suka hinggap di bunga'
            },
            'bunga': {
                definition: 'Bagian tanaman yang berwarna indah dan harum',
                example: 'Bunga mawar sangat harum'
            }
        };

        // Initialize app
        function init() {
            populateStoryLibrary();
            setupDragAndDrop();
            startProgressAnimation();
        }

        // Navigation functions
        function showHome() {
            hideAllPages();
            document.getElementById('homePage').style.display = 'block';
            updateNavigation('home');
            currentPage = 'home';
        }

        function showLibrary(category = null) {
            hideAllPages();
            document.getElementById('libraryPage').style.display = 'block';
            updateNavigation('library');
            currentPage = 'library';
            if (category) {
                filterStoriesByCategory(category);
            }
        }

        function showStoryDetail(storyId) {
            currentStory = stories[storyId];
            if (currentStory) {
                showReader();
            }
        }

        function showReader() {
            hideAllPages();
            document.getElementById('readerPage').style.display = 'block';
            updateNavigation('reader');
            currentPage = 'reader';
            
            if (currentStory) {
                document.getElementById('storyTitle').textContent = currentStory.title;
                document.getElementById('storyText').innerHTML = highlightWords(currentStory.content, currentStory.words);
                document.getElementById('mainIllustration').textContent = currentStory.illustration;
                setupHotspots();
            }
        }

        function showActivities() {
            hideAllPages();
            document.getElementById('activityPage').style.display = 'block';
            updateNavigation('activities');
            currentPage = 'activities';
            resetGame();
        }

        function showDashboard() {
            hideAllPages();
            document.getElementById('dashboardPage').style.display = 'block';
            updateNavigation('dashboard');
            currentPage = 'dashboard';
        }

        function showProfiles() {
            playClickSound();
            alert('Fitur pemilihan profil akan segera hadir!');
        }

        function continueReading() {
            playClickSound();
            showStoryDetail('petualangan-hutan');
        }

        function toggleRecordMode() {
            hideAllPages();
            document.getElementById('recordMode').style.display = 'block';
            currentPage = 'record';
        }

        function goBack() {
            playClickSound();
            if (currentPage === 'reader' || currentPage === 'record') {
                showHome();
            } else {
                history.back();
            }
        }

        function hideAllPages() {
            const pages = ['splashScreen', 'homePage', 'libraryPage', 'readerPage', 'activityPage', 'dashboardPage', 'recordMode'];
            pages.forEach(page => {
                document.getElementById(page).style.display = 'none';
            });
            // Also hide modals
            document.getElementById('definitionModal').style.display = 'none';
            document.getElementById('gameFeedbackModal').style.display = 'none';
        }

        function updateNavigation(activePage) {
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            
            const navMap = {
                'home': 0,
                'library': 1,
                'reader': 2,
                'activities': 3,
                'dashboard': 4
            };
            
            if (navMap[activePage] !== undefined) {
                document.querySelectorAll('.nav-btn')[navMap[activePage]].classList.add('active');
            }
        }

        // Story functions
        function populateStoryLibrary() {
            const storyGrid = document.getElementById('storyGrid');
            storyGrid.innerHTML = '';
            
            Object.keys(stories).forEach(storyId => {
                const story = stories[storyId];
                const card = document.createElement('div');
                card.className = 'story-card';
                card.onclick = () => showStoryDetail(storyId);
                
                card.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 12px;">${story.illustration}</div>
                    <h3>${story.title}</h3>
                    <p>${story.content.substring(0, 50)}...</p>
                    <div style="margin-top: 12px;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                `;
                
                storyGrid.appendChild(card);
            });
        }

        function highlightWords(text, words) {
            let highlightedText = text;
            words.forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                highlightedText = highlightedText.replace(regex, 
                    `<span class="word-highlight" onclick="showDefinition('${word}')">${word}</span>`);
            });
            return highlightedText;
        }

        function setupHotspots() {
            const illustrationPanel = document.querySelector('.illustration-panel');
            // Clear existing hotspots
            illustrationPanel.querySelectorAll('.hotspot').forEach(el => el.remove());
            
            if (currentStory && currentStory.hotspots) {
                currentStory.hotspots.forEach(hotspot => {
                    const hotspotEl = document.createElement('div');
                    hotspotEl.className = 'hotspot';
                    hotspotEl.style.top = hotspot.position.top;
                    hotspotEl.style.left = hotspot.position.left;
                    hotspotEl.textContent = hotspot.emoji;
                    hotspotEl.onclick = () => showHotspot(hotspot.word);
                    illustrationPanel.appendChild(hotspotEl);
                });
            }
        }

        function showDefinition(word) {
            playClickSound();
            const definition = definitions[word];
            if (definition) {
                document.getElementById('wordTitle').textContent = word.charAt(0).toUpperCase() + word.slice(1);
                document.getElementById('wordDefinition').innerHTML = `
                    <p><strong>Arti:</strong> ${definition.definition}</p>
                    <p><strong>Contoh:</strong> ${definition.example}</p>
                `;
                document.getElementById('definitionModal').style.display = 'flex';
            }
        }

        function showHotspot(word) {
            playClickSound();
            showTooltip(word, event.target);
            setTimeout(() => hideTooltip(), 2000);
        }

        function closeModal() {
            playClickSound();
            document.getElementById('definitionModal').style.display = 'none';
        }

        function closeFeedbackModal() {
            playClickSound();
            document.getElementById('gameFeedbackModal').style.display = 'none';
        }

        // Audio functions
        function toggleAudio() {
            playClickSound();
            isPlaying = !isPlaying;
            const playBtn = document.getElementById('playBtn');
            
            if (isPlaying) {
                playBtn.textContent = '‚è∏Ô∏è';
                startAudioProgress();
                highlightCurrentWord();
            } else {
                playBtn.textContent = '‚ñ∂Ô∏è';
                stopAudioProgress();
            }
        }

        function startAudioProgress() {
            const progressBar = document.getElementById('audioProgress');
            const timeDisplay = document.getElementById('audioTime');
            let progress = 0;
            
            const interval = setInterval(() => {
                if (!isPlaying) {
                    clearInterval(interval);
                    return;
                }
                
                progress += 1;
                const percentage = (progress / 150) * 100; // 150 = 2.5 minutes in seconds
                progressBar.style.width = percentage + '%';
                
                const minutes = Math.floor(progress / 60);
                const seconds = progress % 60;
                timeDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')} / 2:30`;
                
                if (progress >= 150) {
                    clearInterval(interval);
                    isPlaying = false;
                    document.getElementById('playBtn').textContent = '‚ñ∂';
                    showActivities();
                }
            }, 100); // Faster for demo
        }

        function stopAudioProgress() {
            // Audio progress stops automatically when isPlaying becomes false
        }

        function highlightCurrentWord() {
            if (!isPlaying) return;
            
            const words = document.querySelectorAll('.word-highlight');
            let currentIndex = 0;
            
            const interval = setInterval(() => {
                if (!isPlaying || currentIndex >= words.length) {
                    clearInterval(interval);
                    return;
                }
                
                // Remove previous highlights
                words.forEach(word => word.classList.remove('highlighted'));
                
                // Add current highlight
                if (words[currentIndex]) {
                    words[currentIndex].classList.add('highlighted');
                }
                
                currentIndex++;
            }, 2000);
        }

        function playWordAudio() {
            playClickSound();
            // Simulate word pronunciation
            setTimeout(() => {
                playSuccessSound();
            }, 500);
        }

        // Recording functions
        function toggleRecording() {
            playClickSound();
            isRecording = !isRecording;
            const micBtn = document.getElementById('micBtn');
            const recordStatus = document.getElementById('recordStatus');
            const recordingWave = document.getElementById('recordingWave');
            
            if (isRecording) {
                micBtn.classList.add('recording');
                micBtn.textContent = '‚èπÔ∏è';
                recordStatus.textContent = 'Sedang merekam... Tekan untuk berhenti';
                recordingWave.style.display = 'flex';
                
                // Simulate recording for 3 seconds
                setTimeout(() => {
                    if (isRecording) {
                        toggleRecording();
                        showRecordingResult();
                    }
                }, 3000);
            } else {
                micBtn.classList.remove('recording');
                micBtn.textContent = 'üé§';
                recordStatus.textContent = 'Tekan untuk mulai merekam';
                recordingWave.style.display = 'none';
            }
        }

        function showRecordingResult() {
            const scoreDisplay = document.getElementById('scoreDisplay');
            const playbackBtn = document.getElementById('playbackBtn');
            
            // Simulate scoring
            const score = Math.floor(Math.random() * 3) + 1; // 1-3 stars
            let stars = '';
            for (let i = 0; i < score; i++) {
                stars += '‚≠ê';
            }
            
            scoreDisplay.textContent = stars;
            scoreDisplay.style.display = 'block';
            playbackBtn.style.display = 'inline-block';
            
            playSuccessSound();
            if (score === 3) {
                createConfetti();
            }
        }

        function playRecording() {
            playClickSound();
            // Simulate playback
            setTimeout(() => {
                alert('Rekaman Anda: "Kiki berjalan ke hutan yang hijau"');
            }, 500);
        }

        function compareWithNarrator() {
            playClickSound();
            alert('Perbandingan dengan narator: Pengucapan Anda 85% mirip!');
        }

        function nextSentence() {
            playClickSound();
            alert('Kalimat berikutnya: "Dia melihat kupu-kupu yang cantik"');
        }

        // Game functions
        function setupDragAndDrop() {
            const wordPieces = document.getElementById('wordPieces');
            const dropZone = document.getElementById('dropZone');
            
            if (!wordPieces || !dropZone) return;
            
            // Add drag event listeners
            wordPieces.addEventListener('dragstart', handleDragStart);
            wordPieces.addEventListener('dragend', handleDragEnd);
            
            dropZone.addEventListener('dragover', handleDragOver);
            dropZone.addEventListener('drop', handleDrop);
        }

        function handleDragStart(e) {
            if (e.target.classList.contains('word-piece')) {
                e.target.classList.add('dragging');
                e.dataTransfer.setData('text/plain', e.target.textContent);
            }
        }

        function handleDragEnd(e) {
            if (e.target.classList.contains('word-piece')) {
                e.target.classList.remove('dragging');
            }
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e) {
            e.preventDefault();
            const wordText = e.dataTransfer.getData('text/plain');
            const dropZone = document.getElementById('dropZone');
            
            // Create dropped word element
            const droppedWord = document.createElement('span');
            droppedWord.textContent = wordText + ' ';
            droppedWord.style.background = '#8BC34A';
            droppedWord.style.color = 'white';
            droppedWord.style.padding = '4px 8px';
            droppedWord.style.borderRadius = '4px';
            droppedWord.style.margin = '2px';
            droppedWord.style.display = 'inline-block';
            
            if (currentGameType === 'sentence') {
                if (dropZone.querySelector('p')) {
                    dropZone.querySelector('p').remove();
                }
                dropZone.appendChild(droppedWord);
            } else if (currentGameType === 'matching') {
                const imageCard = e.target.closest('div');
                if (imageCard && imageCard.parentElement === dropZone.querySelector('div')) {
                    // Check if the image card already has a word
                    if (!imageCard.querySelector('span')) {
                        imageCard.appendChild(droppedWord);
                    }
                }
            }
            
            // Remove the dragged piece
            const pieces = document.querySelectorAll('.word-piece');
            pieces.forEach(piece => {
                if (piece.textContent === wordText && piece.classList.contains('dragging')) {
                    piece.remove();
                }
            });
            
            updateGameProgress();
            playClickSound();
        }

        function checkAnswer() {
            playClickSound();
            const dropZone = document.getElementById('dropZone');
            
            if (currentGameType === 'sentence') {
                const droppedWords = Array.from(dropZone.children).map(el => el.textContent.trim());
                const correctOrder = ['Kiki', 'berjalan', 'ke', 'hutan'];
                
                if (JSON.stringify(droppedWords) === JSON.stringify(correctOrder)) {
                    showFeedbackModal('Hebat!', 'Kalimat Anda benar! üéâ');
                    playSuccessSound();
                    createConfetti();
                    updateGameProgress(100);
                } else {
                    showFeedbackModal('Coba Lagi!', 'Susun kata-kata dengan urutan yang tepat.');
                }
            } else if (currentGameType === 'matching') {
                const imageCards = dropZone.querySelectorAll('div > div');
                const correctMatches = [
                    { image: 'üê±', word: 'kucing' },
                    { image: 'üê∂', word: 'anjing' },
                    { image: 'üå∏', word: 'bunga' },
                    { image: 'üå≥', word: 'pohon' }
                ];
                let allCorrect = true;
                
                imageCards.forEach(card => {
                    const image = card.textContent.trim().split(' ')[0];
                    const word = card.querySelector('span') ? card.querySelector('span').textContent.trim() : '';
                    const correctMatch = correctMatches.find(match => match.image === image);
                    if (!correctMatch || correctMatch.word !== word) {
                        allCorrect = false;
                    }
                });
                
                if (allCorrect && imageCards.length === correctMatches.length) {
                    showFeedbackModal('Hebat!', 'Semua gambar dan kata cocok! üéâ');
                    playSuccessSound();
                    createConfetti();
                    updateGameProgress(100);
                } else {
                    showFeedbackModal('Coba Lagi!', 'Pastikan semua kata cocok dengan gambar yang tepat.');
                }
            }
        }

        function showFeedbackModal(title, message) {
            document.getElementById('feedbackTitle').textContent = title;
            document.getElementById('feedbackMessage').textContent = message;
            document.getElementById('gameFeedbackModal').style.display = 'flex';
        }

        function nextGame() {
            playClickSound();
            resetGame();
            currentGameType = 'matching';
            document.getElementById('gameTitle').textContent = 'üéØ Cocokkan Gambar';
            document.getElementById('gameInstruction').textContent = 'Cocokkan gambar dengan kata yang tepat!';
            
            // Update game content for matching game
            const dropZone = document.getElementById('dropZone');
            const wordPieces = document.getElementById('wordPieces');
            
            dropZone.innerHTML = '<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; width: 100%;"></div>';
            wordPieces.innerHTML = '';
            
            // Add matching game elements
            const games = [
                { image: 'üê±', word: 'kucing' },
                { image: 'üê∂', word: 'anjing' },
                { image: 'üå∏', word: 'bunga' },
                { image: 'üå≥', word: 'pohon' }
            ];
            
            const gameGrid = dropZone.querySelector('div');
            games.forEach(game => {
                const imageCard = document.createElement('div');
                imageCard.style.cssText = 'background: #f9f9f9; padding: 20px; border-radius: 8px; text-align: center; font-size: 48px; border: 2px dashed #ddd;';
                imageCard.textContent = game.image;
                gameGrid.appendChild(imageCard);
                
                const wordCard = document.createElement('div');
                wordCard.className = 'word-piece';
                wordCard.textContent = game.word;
                wordCard.draggable = true;
                wordPieces.appendChild(wordCard);
            });
            
            setupDragAndDrop();
        }

        function resetGame() {
            gameProgress = 0;
            updateGameProgress(0);
            currentGameType = 'sentence';
            document.getElementById('gameTitle').textContent = 'üéØ Susun Kalimat';
            document.getElementById('gameInstruction').textContent = 'Seret kata-kata ke tempat yang tepat!';
            
            const dropZone = document.getElementById('dropZone');
            dropZone.innerHTML = '<p style="color: #999;">Seret kata-kata ke sini</p>';
            
            const wordPieces = document.getElementById('wordPieces');
            wordPieces.innerHTML = `
                <div class="word-piece" draggable="true">Kiki</div>
                <div class="word-piece" draggable="true">berjalan</div>
                <div class="word-piece" draggable="true">ke</div>
                <div class="word-piece" draggable="true">hutan</div>
            `;
        }

        function updateGameProgress(progress = null) {
            if (progress !== null) {
                gameProgress = progress;
            } else {
                gameProgress += 25; // Each word adds 25%
            }
            
            const progressBar = document.getElementById('gameProgress');
            if (progressBar) {
                progressBar.style.width = gameProgress + '%';
            }
        }

        // Utility functions
        function showTooltip(text, target) {
            const tooltip = document.getElementById('tooltip');
            tooltip.textContent = text;
            tooltip.classList.add('show');
            
            const rect = target.getBoundingClientRect();
            tooltip.style.left = rect.left + 'px';
            tooltip.style.top = (rect.top - 40) + 'px';
        }

        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = ['#FFD54F', '#8BC34A', '#81CFFE', '#F8BBD0', '#CE93D8'][Math.floor(Math.random() * 5)];
                    confetti.style.animationDelay = Math.random() * 3 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 50);
            }
        }

        function startProgressAnimation() {
            // Animate progress bars on load
            setTimeout(() => {
                const progressBars = document.querySelectorAll('.progress-fill');
                progressBars.forEach(bar => {
                    bar.style.width = '65%';
                });
            }, 500);
        }

        function filterStoriesByCategory(category) {
            // Filter stories by category (simplified for demo)
            const allCards = document.querySelectorAll('#storyGrid .story-card');
            allCards.forEach(card => {
                card.style.display = 'block'; // Show all for demo
            });
        }

        // Sound effects (simulated)
        function playClickSound() {
            // In a real app, this would play an actual sound file
            console.log('üîä Click sound');
        }

        function playSuccessSound() {
            // In a real app, this would play an actual success sound
            console.log('üîä Success sound');
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            init();
            
            // Show splash screen initially
            setTimeout(() => {
                // Auto-advance to home after 3 seconds for demo
                // showHome();
            }, 3000);
        });

        // Keyboard shortcuts for development
        document.addEventListener('keydown', function(e) {
            if (e.key === '1') showHome();
            if (e.key === '2') showLibrary();
            if (e.key === '3') continueReading();
            if (e.key === '4') showActivities();
            if (e.key === '5') showDashboard();
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            // Adjust layout for different screen sizes
            const container = document.querySelector('.container');
            if (window.innerWidth < 768) {
                container.style.padding = '12px';
            } else {
                container.style.padding = '16px';
            }
        });
    </script>
</body>
</html>